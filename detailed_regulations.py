# detailed_regulations.py
# 상세한 국가별 규제 정보

import pandas as pd
import json
from datetime import datetime

# 상세한 국가별 규제 데이터
DETAILED_REGULATIONS = {
    "중국": {
        "라면": {
            "제한사항": [
                "방부제 함량 제한: 0.1% 이하 (BHA, BHT, TBHQ 등)",
                "라벨에 중국어 표기 필수 (제품명, 성분, 원산지, 유통기한)",
                "식품안전인증 필요 (GB 2760-2014 기준)",
                "원산지 명시 필수 (중국어로 표기)",
                "알레르기 정보 표시 필수 (8대 알레르기 원료)",
                "영양성분표 필수 (100g당 열량, 단백질, 지방, 탄수화물, 나트륨)",
                "식품첨가물 기준 준수 (중국 식품첨가물 사용기준)",
                "미생물 기준: 총균수 10,000 CFU/g 이하, 대장균군 음성"
            ],
            "허용기준": [
                "방부제 0.1% 이하 (BHA, BHT, TBHQ, PG 등)",
                "원산지 명시 필수 (중국어로 표기)",
                "중국어 라벨 필수 (제품명, 성분, 원산지, 유통기한, 보관방법)",
                "식품안전인증서 소지 (GB 2760-2014 기준)",
                "알레르기 정보 표시 (8대 알레르기 원료 포함 여부)",
                "영양성분표 표시 (100g당 기준)",
                "식품첨가물 기준 준수 (중국 식품첨가물 사용기준)",
                "미생물 기준 준수 (총균수, 대장균군, 황색포도상구균 등)"
            ],
            "필요서류": [
                "식품안전인증서 (GB 2760-2014 기준)",
                "성분분석서 (방부제, 식품첨가물 함량)",
                "원산지증명서 (한국산임을 증명하는 서류)",
                "중국어 라벨 (제품명, 성분, 원산지, 유통기한, 보관방법)",
                "알레르기 정보서 (8대 알레르기 원료 포함 여부)",
                "영양성분분석서 (100g당 기준)",
                "미생물검사서 (총균수, 대장균군, 황색포도상구균)",
                "제조시설 등록증 (한국 제조시설 등록증)",
                "수출신고서 (중국 수입신고서)"
            ],
            "통관절차": [
                "1. 수출신고 (한국 관세청)",
                "2. 검역검사 (중국 검역소)",
                "3. 식품안전검사 (중국 식품의약품감독관리총국)",
                "4. 라벨 검사 (중국어 라벨 적합성)",
                "5. 통관승인 (중국 세관)",
                "6. 국내 유통 허가 (중국 식품의약품감독관리총국)"
            ],
            "주의사항": [
                "중국어 라벨 미표기 시 반송 가능 (라벨 번역 전문업체 이용 권장)",
                "방부제 함량 초과 시 폐기 처리 (0.1% 이하 준수 필수)",
                "알레르기 정보 미표기 시 반송 (8대 알레르기 원료 포함 여부)",
                "원산지 미표기 시 반송 (중국어로 '한국산' 표기 필수)",
                "식품안전인증서 미소지 시 반송 (GB 2760-2014 기준)",
                "미생물 기준 초과 시 폐기 (총균수, 대장균군 등)",
                "유통기한 표기 오류 시 반송 (YYYY-MM-DD 형식)",
                "보관방법 미표기 시 반송 (온도, 습도 등)"
            ],
            "추가정보": {
                "관련법규": "중국 식품안전법, 식품첨가물 사용기준 GB 2760-2014",
                "검사기관": "중국 식품의약품감독관리총국, 검역소",
                "처리기간": "통상 7-14일 (검사 결과에 따라 변동)",
                "수수료": "검사비 약 2,000-5,000위안 (제품별 차이)",
                "최종업데이트": "2024-01-15",
                "원본언어": "zh-CN",
                "번역출처": "MFDS CES Food DataBase"
            }
        },
        "김치": {
            "제한사항": [
                "발효식품 안전기준 준수 (중국 발효식품 안전기준)",
                "라벨에 중국어 표기 필수 (제품명, 성분, 원산지, 유통기한)",
                "식품안전인증 필요 (GB 2760-2014 기준)",
                "원산지 명시 필수 (중국어로 표기)",
                "알레르기 정보 표시 필수 (8대 알레르기 원료)",
                "영양성분표 필수 (100g당 기준)",
                "식품첨가물 기준 준수 (중국 식품첨가물 사용기준)",
                "미생물 기준: 총균수 10,000 CFU/g 이하, 대장균군 음성"
            ],
            "허용기준": [
                "발효식품 안전기준 준수 (중국 발효식품 안전기준)",
                "원산지 명시 필수 (중국어로 표기)",
                "중국어 라벨 필수 (제품명, 성분, 원산지, 유통기한, 보관방법)",
                "식품안전인증서 소지 (GB 2760-2014 기준)",
                "알레르기 정보 표시 (8대 알레르기 원료 포함 여부)",
                "영양성분표 표시 (100g당 기준)",
                "식품첨가물 기준 준수 (중국 식품첨가물 사용기준)",
                "미생물 기준 준수 (총균수, 대장균군, 황색포도상구균 등)"
            ],
            "필요서류": [
                "식품안전인증서 (GB 2760-2014 기준)",
                "성분분석서 (식품첨가물 함량)",
                "원산지증명서 (한국산임을 증명하는 서류)",
                "중국어 라벨 (제품명, 성분, 원산지, 유통기한, 보관방법)",
                "알레르기 정보서 (8대 알레르기 원료 포함 여부)",
                "영양성분분석서 (100g당 기준)",
                "미생물검사서 (총균수, 대장균군, 황색포도상구균)",
                "제조시설 등록증 (한국 제조시설 등록증)",
                "수출신고서 (중국 수입신고서)"
            ],
            "통관절차": [
                "1. 수출신고 (한국 관세청)",
                "2. 검역검사 (중국 검역소)",
                "3. 식품안전검사 (중국 식품의약품감독관리총국)",
                "4. 라벨 검사 (중국어 라벨 적합성)",
                "5. 통관승인 (중국 세관)",
                "6. 국내 유통 허가 (중국 식품의약품감독관리총국)"
            ],
            "주의사항": [
                "중국어 라벨 미표기 시 반송 가능 (라벨 번역 전문업체 이용 권장)",
                "발효식품 안전기준 미준수 시 폐기 처리",
                "알레르기 정보 미표기 시 반송 (8대 알레르기 원료 포함 여부)",
                "원산지 미표기 시 반송 (중국어로 '한국산' 표기 필수)",
                "식품안전인증서 미소지 시 반송 (GB 2760-2014 기준)",
                "미생물 기준 초과 시 폐기 (총균수, 대장균군 등)",
                "유통기한 표기 오류 시 반송 (YYYY-MM-DD 형식)",
                "보관방법 미표기 시 반송 (온도, 습도 등)"
            ],
            "추가정보": {
                "관련법규": "중국 식품안전법, 발효식품 안전기준",
                "검사기관": "중국 식품의약품감독관리총국, 검역소",
                "처리기간": "통상 7-14일 (검사 결과에 따라 변동)",
                "수수료": "검사비 약 2,000-5,000위안 (제품별 차이)",
                "최종업데이트": "2024-01-15",
                "원본언어": "zh-CN",
                "번역출처": "MFDS CES Food DataBase"
            }
        }
    },
    "미국": {
        "라면": {
            "제한사항": [
                "FDA 승인 필요 (식품첨가물 승인 목록 확인)",
                "영양성분표 필수 (Serving Size 기준)",
                "알레르기 정보 표시 (8대 알레르기 원료)",
                "식품첨가물 기준 (FDA GRAS 목록)",
                "라벨 영어 표기 필수 (제품명, 성분, 원산지, 유통기한)",
                "원산지 명시 필수 (Country of Origin)",
                "제조시설 등록 필요 (FDA 제조시설 등록)",
                "미생물 기준: 총균수 10,000 CFU/g 이하, 대장균군 음성"
            ],
            "허용기준": [
                "식품첨가물 기준 준수 (FDA GRAS 목록)",
                "영양성분 기준 준수 (Serving Size 기준)",
                "알레르기 정보 표시 (8대 알레르기 원료 포함 여부)",
                "라벨 영어 표기 (제품명, 성분, 원산지, 유통기한, 보관방법)",
                "원산지 명시 (Country of Origin)",
                "제조시설 등록 (FDA 제조시설 등록)",
                "미생물 기준 준수 (총균수, 대장균군, 황색포도상구균 등)",
                "식품안전 현대화법(FSMA) 준수"
            ],
            "필요서류": [
                "FDA 등록증 (제조시설 등록증)",
                "영양성분분석서 (Serving Size 기준)",
                "알레르기 정보서 (8대 알레르기 원료 포함 여부)",
                "성분분석서 (식품첨가물 함량)",
                "원산지증명서 (한국산임을 증명하는 서류)",
                "영어 라벨 (제품명, 성분, 원산지, 유통기한, 보관방법)",
                "미생물검사서 (총균수, 대장균군, 황색포도상구균)",
                "제조시설 등록증 (FDA 제조시설 등록증)",
                "수출신고서 (미국 수입신고서)"
            ],
            "통관절차": [
                "1. 수출신고 (한국 관세청)",
                "2. FDA 검사 (미국 식품의약품청)",
                "3. 라벨 검사 (영어 라벨 적합성)",
                "4. 통관승인 (미국 세관)",
                "5. 국내 유통 허가 (미국 식품의약품청)"
            ],
            "주의사항": [
                "FDA 미승인 시 반송 (식품첨가물 승인 목록 확인 필수)",
                "알레르기 정보 미표기 시 폐기 (8대 알레르기 원료 포함 여부)",
                "영어 라벨 미표기 시 반송 (영어 라벨 필수)",
                "원산지 미표기 시 반송 (Country of Origin 표기 필수)",
                "제조시설 미등록 시 반송 (FDA 제조시설 등록 필수)",
                "미생물 기준 초과 시 폐기 (총균수, 대장균군 등)",
                "영양성분표 오류 시 반송 (Serving Size 기준)",
                "식품안전 현대화법(FSMA) 미준수 시 반송"
            ],
            "추가정보": {
                "관련법규": "미국 식품안전법, 식품안전 현대화법(FSMA)",
                "검사기관": "미국 식품의약품청(FDA), 세관",
                "처리기간": "통상 5-10일 (검사 결과에 따라 변동)",
                "수수료": "검사비 약 $500-1,500 (제품별 차이)",
                "최종업데이트": "2024-01-15",
                "원본언어": "en-US",
                "번역출처": "MFDS CES Food DataBase"
            }
        }
    },
    "일본": {
        "라면": {
            "제한사항": [
                "농약잔류량 기준 (0.01ppm 이하)",
                "방사능 검사 통과 (세슘-134, 137 기준)",
                "식품첨가물 기준 (일본 식품첨가물 사용기준)",
                "라벨 일본어 표기 (제품명, 성분, 원산지, 유통기한)",
                "원산지 명시 필수 (일본어로 표기)",
                "알레르기 정보 표시 (7대 알레르기 원료)",
                "영양성분표 필수 (100g당 기준)",
                "미생물 기준: 총균수 10,000 CFU/g 이하, 대장균군 음성"
            ],
            "허용기준": [
                "농약잔류량 0.01ppm 이하 (일본 농약잔류량 기준)",
                "방사능 기준 이하 (세슘-134, 137 기준)",
                "식품첨가물 기준 준수 (일본 식품첨가물 사용기준)",
                "라벨 일본어 표기 (제품명, 성분, 원산지, 유통기한, 보관방법)",
                "원산지 명시 (일본어로 표기)",
                "알레르기 정보 표시 (7대 알레르기 원료 포함 여부)",
                "영양성분표 표시 (100g당 기준)",
                "미생물 기준 준수 (총균수, 대장균군, 황색포도상구균 등)"
            ],
            "필요서류": [
                "농약잔류량검사서 (0.01ppm 이하)",
                "방사능검사서 (세슘-134, 137 기준)",
                "식품첨가물 분석서 (일본 식품첨가물 사용기준)",
                "성분분석서 (식품첨가물 함량)",
                "원산지증명서 (한국산임을 증명하는 서류)",
                "일본어 라벨 (제품명, 성분, 원산지, 유통기한, 보관방법)",
                "알레르기 정보서 (7대 알레르기 원료 포함 여부)",
                "영양성분분석서 (100g당 기준)",
                "미생물검사서 (총균수, 대장균군, 황색포도상구균)",
                "제조시설 등록증 (일본 제조시설 등록증)",
                "수출신고서 (일본 수입신고서)"
            ],
            "통관절차": [
                "1. 수출신고 (한국 관세청)",
                "2. 검역검사 (일본 검역소)",
                "3. 농약잔류량 검사 (일본 식품의약품안전청)",
                "4. 방사능 검사 (일본 원자력규제위원회)",
                "5. 라벨 검사 (일본어 라벨 적합성)",
                "6. 통관승인 (일본 세관)",
                "7. 국내 유통 허가 (일본 식품의약품안전청)"
            ],
            "주의사항": [
                "방사능 검사 불합격 시 반송 (세슘-134, 137 기준)",
                "농약잔류량 초과 시 폐기 (0.01ppm 이하 준수 필수)",
                "일본어 라벨 미표기 시 반송 (일본어 라벨 필수)",
                "원산지 미표기 시 반송 (일본어로 표기 필수)",
                "알레르기 정보 미표기 시 반송 (7대 알레르기 원료 포함 여부)",
                "미생물 기준 초과 시 폐기 (총균수, 대장균군 등)",
                "영양성분표 오류 시 반송 (100g당 기준)",
                "식품첨가물 기준 미준수 시 반송"
            ],
            "추가정보": {
                "관련법규": "일본 식품위생법, 농약잔류량 기준",
                "검사기관": "일본 식품의약품안전청, 검역소, 원자력규제위원회",
                "처리기간": "통상 10-20일 (검사 결과에 따라 변동)",
                "수수료": "검사비 약 50,000-100,000엔 (제품별 차이)",
                "최종업데이트": "2024-01-15",
                "원본언어": "ja-JP",
                "번역출처": "MFDS CES Food DataBase"
            }
        }
    },
    "EU": {
        "라면": {
            "제한사항": [
                "EU 식품안전기준 준수 (EU 식품안전법)",
                "라벨 영어 표기 (제품명, 성분, 원산지, 유통기한)",
                "영양성분표 필수 (100g당 기준)",
                "알레르기 정보 표시 (14대 알레르기 원료)",
                "원산지 명시 필수 (Country of Origin)",
                "식품첨가물 기준 (EU 식품첨가물 사용기준)",
                "미생물 기준: 총균수 10,000 CFU/g 이하, 대장균군 음성",
                "GMO 표시 필수 (GMO 함유 시)"
            ],
            "허용기준": [
                "EU 식품첨가물 기준 (EU 식품첨가물 사용기준)",
                "영양성분 기준 (100g당 기준)",
                "알레르기 정보 표시 (14대 알레르기 원료 포함 여부)",
                "라벨 영어 표기 (제품명, 성분, 원산지, 유통기한, 보관방법)",
                "원산지 명시 (Country of Origin)",
                "미생물 기준 준수 (총균수, 대장균군, 황색포도상구균 등)",
                "GMO 표시 (GMO 함유 시)",
                "EU 식품안전법 준수"
            ],
            "필요서류": [
                "EU 식품안전인증서 (EU 식품안전법 기준)",
                "영양성분분석서 (100g당 기준)",
                "알레르기 정보서 (14대 알레르기 원료 포함 여부)",
                "성분분석서 (식품첨가물 함량)",
                "원산지증명서 (한국산임을 증명하는 서류)",
                "영어 라벨 (제품명, 성분, 원산지, 유통기한, 보관방법)",
                "미생물검사서 (총균수, 대장균군, 황색포도상구균)",
                "GMO 검사서 (GMO 함유 여부)",
                "제조시설 등록증 (EU 제조시설 등록증)",
                "수출신고서 (EU 수입신고서)"
            ],
            "통관절차": [
                "1. 수출신고 (한국 관세청)",
                "2. EU 검사 (EU 식품안전청)",
                "3. 라벨 검사 (영어 라벨 적합성)",
                "4. 통관승인 (EU 세관)",
                "5. 국내 유통 허가 (EU 식품안전청)"
            ],
            "주의사항": [
                "EU 기준 미준수 시 반송 (EU 식품안전법 준수 필수)",
                "알레르기 정보 미표기 시 폐기 (14대 알레르기 원료 포함 여부)",
                "영어 라벨 미표기 시 반송 (영어 라벨 필수)",
                "원산지 미표기 시 반송 (Country of Origin 표기 필수)",
                "미생물 기준 초과 시 폐기 (총균수, 대장균군 등)",
                "영양성분표 오류 시 반송 (100g당 기준)",
                "GMO 미표시 시 반송 (GMO 함유 시)",
                "EU 식품안전법 미준수 시 반송"
            ],
            "추가정보": {
                "관련법규": "EU 식품안전법, EU 식품첨가물 사용기준",
                "검사기관": "EU 식품안전청, 세관",
                "처리기간": "통상 7-15일 (검사 결과에 따라 변동)",
                "수수료": "검사비 약 €300-800 (제품별 차이)",
                "최종업데이트": "2024-01-15",
                "원본언어": "en-GB",
                "번역출처": "MFDS CES Food DataBase"
            }
        }
    }
}

def get_detailed_regulations(country, product):
    """상세한 국가별 규제정보 조회"""
    if country in DETAILED_REGULATIONS:
        if product in DETAILED_REGULATIONS[country]:
            return DETAILED_REGULATIONS[country][product]
    return None

def search_detailed_regulations(keyword):
    """키워드로 상세 규제정보 검색"""
    results = []
    for country, products in DETAILED_REGULATIONS.items():
        for product, regulations in products.items():
            if keyword in product or any(keyword in str(reg) for reg in regulations.values()):
                results.append({
                    "국가": country,
                    "제품": product,
                    "규정": regulations
                })
    return results

def get_all_countries():
    """모든 수출대상국 목록 반환"""
    return list(DETAILED_REGULATIONS.keys())

def get_all_products():
    """모든 제품 카테고리 목록 반환"""
    products = set()
    for country_data in DETAILED_REGULATIONS.values():
        products.update(country_data.keys())
    return list(products)

def display_detailed_regulation_info(country, product):
    """상세한 규제정보 출력"""
    regulations = get_detailed_regulations(country, product)
    if not regulations:
        return f"❌ {country}의 {product}에 대한 상세 규제정보가 없습니다."
    
    result = f"\n📋 {country} - {product} 상세 규제정보\n"
    result += "=" * 60 + "\n"
    
    for key, value in regulations.items():
        if key == "추가정보":
            continue
        result += f"\n🔸 {key}:\n"
        if isinstance(value, list):
            for i, item in enumerate(value, 1):
                result += f"   {i:2d}. {item}\n"
        else:
            result += f"   {value}\n"
    
    # 추가정보 표시
    if "추가정보" in regulations:
        result += f"\n📊 추가 정보:\n"
        result += "-" * 40 + "\n"
        for key, value in regulations["추가정보"].items():
            result += f"   {key}: {value}\n"
    
    return result 