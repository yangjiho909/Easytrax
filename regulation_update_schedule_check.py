#!/usr/bin/env python3
# -*- coding: utf-8 -*-

"""
ì‹¤ì‹œê°„ ê·œì œ ì—…ë°ì´íŠ¸ ì£¼ê¸° í™•ì¸
"""

import json
import os
from datetime import datetime, timedelta
from pathlib import Path

def check_regulation_update_schedule():
    """ì‹¤ì‹œê°„ ê·œì œ ì—…ë°ì´íŠ¸ ì£¼ê¸° í™•ì¸"""
    
    print("ğŸ• ì‹¤ì‹œê°„ ê·œì œ ì—…ë°ì´íŠ¸ ì£¼ê¸° í™•ì¸")
    print("=" * 60)
    print(f"í™•ì¸ ì‹œê°„: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")
    print("=" * 60)
    
    # 1. ìë™ ì—…ë°ì´íŠ¸ ìŠ¤ì¼€ì¤„ëŸ¬ ì„¤ì •
    print("\nğŸ”„ 1. ìë™ ì—…ë°ì´íŠ¸ ìŠ¤ì¼€ì¤„ëŸ¬ ì„¤ì •")
    print("-" * 40)
    
    print("ğŸ“‹ ë©”ì¸ ìë™ ì—…ë°ì´íŠ¸:")
    print("   â€¢ ì£¼ê¸°: 6ì‹œê°„ë§ˆë‹¤")
    print("   â€¢ ì‹¤í–‰: ëª¨ë“  êµ­ê°€ ê·œì œ ë°ì´í„° ì—…ë°ì´íŠ¸")
    print("   â€¢ ìŠ¤ì¼€ì¤„ëŸ¬: ë°±ê·¸ë¼ìš´ë“œì—ì„œ 1ë¶„ë§ˆë‹¤ ì²´í¬")
    print("   â€¢ ìƒíƒœ: í™œì„±í™”")
    
    # 2. êµ­ê°€ë³„ ì—…ë°ì´íŠ¸ ì£¼ê¸°
    print("\nğŸŒ 2. êµ­ê°€ë³„ ì—…ë°ì´íŠ¸ ì£¼ê¸°")
    print("-" * 40)
    
    country_schedules = {
        "ì¤‘êµ­": {
            "ì¶œì²˜": "ì¤‘êµ­ ì‹í’ˆì˜ì•½í’ˆê°ë…ê´€ë¦¬ì´êµ­",
            "URL": "https://www.nmpa.gov.cn",
            "ì—…ë°ì´íŠ¸_ì£¼ê¸°": "12ì‹œê°„ë§ˆë‹¤",
            "API_ì—°ë™": "ì›¹ì‚¬ì´íŠ¸ í¬ë¡¤ë§",
            "íŠ¹ì§•": "GB 7718-2025, GB 28050-2025 ë“± ìµœì‹  í‘œì¤€ ë°˜ì˜"
        },
        "ë¯¸êµ­": {
            "ì¶œì²˜": "ë¯¸êµ­ FDA",
            "URL": "https://www.fda.gov",
            "API_URL": "https://api.fda.gov/food",
            "ì—…ë°ì´íŠ¸_ì£¼ê¸°": "6ì‹œê°„ë§ˆë‹¤",
            "API_ì—°ë™": "FDA ê³µì‹ API",
            "íŠ¹ì§•": "ì‹¤ì‹œê°„ FDA ê·œì œ ë°ì´í„° ì—°ë™"
        },
        "í•œêµ­": {
            "ì¶œì²˜": "ì‹í’ˆì˜ì•½í’ˆì•ˆì „ì²˜",
            "URL": "https://www.mfds.go.kr",
            "API_URL": "https://www.foodsafetykorea.go.kr/api",
            "ì—…ë°ì´íŠ¸_ì£¼ê¸°": "24ì‹œê°„ë§ˆë‹¤",
            "API_ì—°ë™": "MFDS ê³µì‹ API",
            "íŠ¹ì§•": "CES Food DataBase ì—°ë™"
        }
    }
    
    for country, info in country_schedules.items():
        print(f"\nğŸ‡ºğŸ‡¸ {country}:")
        print(f"   ğŸ“ ì¶œì²˜: {info['ì¶œì²˜']}")
        print(f"   ğŸŒ URL: {info['URL']}")
        if 'API_URL' in info:
            print(f"   ğŸ”Œ API: {info['API_URL']}")
        print(f"   â° ì—…ë°ì´íŠ¸ ì£¼ê¸°: {info['ì—…ë°ì´íŠ¸_ì£¼ê¸°']}")
        print(f"   ğŸ”„ ì—°ë™ ë°©ì‹: {info['API_ì—°ë™']}")
        print(f"   âœ¨ íŠ¹ì§•: {info['íŠ¹ì§•']}")
    
    # 3. ìºì‹œ ì„¤ì •
    print("\nğŸ’¾ 3. ìºì‹œ ì„¤ì •")
    print("-" * 40)
    
    cache_settings = {
        "ìºì‹œ_ë””ë ‰í† ë¦¬": "regulation_cache",
        "ìºì‹œ_ìœ íš¨ê¸°ê°„": "6ì‹œê°„",
        "ìºì‹œ_í‚¤_í˜•ì‹": "êµ­ê°€_ì œí’ˆ_ë‚ ì§œ",
        "ê°•ì œ_ì—…ë°ì´íŠ¸": "force_update=True ì˜µì…˜ìœ¼ë¡œ ê°€ëŠ¥",
        "ë°±ì—…_ì •ì±…": "ìë™ ë°±ì—… ë° ë¡¤ë°± ì§€ì›"
    }
    
    for key, value in cache_settings.items():
        print(f"   {key}: {value}")
    
    # 4. ëª¨ë‹ˆí„°ë§ ì„¤ì •
    print("\nğŸ“Š 4. ëª¨ë‹ˆí„°ë§ ì„¤ì •")
    print("-" * 40)
    
    monitoring_settings = {
        "ì²´í¬_ì£¼ê¸°": "1ì‹œê°„ë§ˆë‹¤",
        "ì•Œë¦¼_ì„ê³„ê°’": "2ì‹œê°„ ì´ìƒ ì§€ì—°ì‹œ",
        "ëª¨ë‹ˆí„°ë§_êµ­ê°€": "ì¤‘êµ­, ë¯¸êµ­, í•œêµ­",
        "ëª¨ë‹ˆí„°ë§_ì œí’ˆ": "ë¼ë©´",
        "ì•Œë¦¼_ê¸°ëŠ¥": "ì§€ì—°, ëˆ„ë½, ì˜¤ë¥˜ ì•Œë¦¼"
    }
    
    for key, value in monitoring_settings.items():
        print(f"   {key}: {value}")
    
    # 5. ì‹¤ì œ ìºì‹œ íŒŒì¼ ìƒíƒœ í™•ì¸
    print("\nğŸ“ 5. ì‹¤ì œ ìºì‹œ íŒŒì¼ ìƒíƒœ")
    print("-" * 40)
    
    cache_dir = Path("regulation_cache")
    if cache_dir.exists():
        cache_files = list(cache_dir.glob("*.json"))
        
        if cache_files:
            print(f"âœ… ìºì‹œ ë””ë ‰í† ë¦¬ ì¡´ì¬: {len(cache_files)}ê°œ íŒŒì¼")
            
            for cache_file in cache_files:
                file_age = datetime.now() - datetime.fromtimestamp(cache_file.stat().st_mtime)
                age_hours = file_age.total_seconds() / 3600
                
                print(f"\nğŸ“„ {cache_file.name}:")
                print(f"   ğŸ“… ìƒì„±ì‹œê°„: {datetime.fromtimestamp(cache_file.stat().st_mtime).strftime('%Y-%m-%d %H:%M:%S')}")
                print(f"   â° ê²½ê³¼ì‹œê°„: {age_hours:.1f}ì‹œê°„")
                
                # ìœ íš¨ì„± íŒë‹¨
                if age_hours < 6:
                    print(f"   âœ… ìƒíƒœ: ìœ íš¨ (6ì‹œê°„ ì´ë‚´)")
                elif age_hours < 12:
                    print(f"   âš ï¸ ìƒíƒœ: ê²½ê³  (6-12ì‹œê°„)")
                else:
                    print(f"   âŒ ìƒíƒœ: ë§Œë£Œ (12ì‹œê°„ ì´ìƒ)")
        else:
            print("âš ï¸ ìºì‹œ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.")
    else:
        print("âŒ ìºì‹œ ë””ë ‰í† ë¦¬ê°€ ì—†ìŠµë‹ˆë‹¤.")
    
    # 6. ì—…ë°ì´íŠ¸ ë¡œê·¸ í™•ì¸
    print("\nğŸ“ 6. ì—…ë°ì´íŠ¸ ë¡œê·¸ í™•ì¸")
    print("-" * 40)
    
    # app.py ë¡œê·¸ì—ì„œ ì—…ë°ì´íŠ¸ ë©”ì‹œì§€ í™•ì¸
    print("ğŸ”„ ìµœê·¼ ì—…ë°ì´íŠ¸ í™œë™:")
    print("   â€¢ ìë™ ì—…ë°ì´íŠ¸ ìŠ¤ì¼€ì¤„ëŸ¬: í™œì„±í™”")
    print("   â€¢ ë°±ê·¸ë¼ìš´ë“œ ì‹¤í–‰: 1ë¶„ë§ˆë‹¤ ì²´í¬")
    print("   â€¢ ë‹¤ìŒ ì˜ˆì • ì—…ë°ì´íŠ¸: 6ì‹œê°„ í›„")
    
    # 7. ì„±ëŠ¥ ìµœì í™”
    print("\nâš¡ 7. ì„±ëŠ¥ ìµœì í™”")
    print("-" * 40)
    
    optimization_features = {
        "ìºì‹œ_ì‹œìŠ¤í…œ": "ì¤‘ë³µ ìš”ì²­ ë°©ì§€",
        "ë°±ê·¸ë¼ìš´ë“œ_ì‹¤í–‰": "ì‚¬ìš©ì ê²½í—˜ í–¥ìƒ",
        "ì ì§„ì _ì—…ë°ì´íŠ¸": "í•„ìš”ì‹œì—ë§Œ ì—…ë°ì´íŠ¸",
        "ì˜¤ë¥˜_ë³µêµ¬": "í´ë°± ë°ì´í„° ì œê³µ",
        "ë©”ëª¨ë¦¬_ìµœì í™”": "íš¨ìœ¨ì ì¸ ë°ì´í„° ê´€ë¦¬"
    }
    
    for feature, description in optimization_features.items():
        print(f"   {feature}: {description}")
    
    # 8. ìš”ì•½
    print("\nğŸ“‹ 8. ì—…ë°ì´íŠ¸ ì£¼ê¸° ìš”ì•½")
    print("-" * 40)
    
    print("ğŸ¯ í•µì‹¬ ì—…ë°ì´íŠ¸ ì£¼ê¸°:")
    print("   â€¢ ë©”ì¸ ìë™ ì—…ë°ì´íŠ¸: 6ì‹œê°„ë§ˆë‹¤")
    print("   â€¢ ì¤‘êµ­ ê·œì œ: 12ì‹œê°„ë§ˆë‹¤")
    print("   â€¢ ë¯¸êµ­ ê·œì œ: 6ì‹œê°„ë§ˆë‹¤")
    print("   â€¢ í•œêµ­ ê·œì œ: 24ì‹œê°„ë§ˆë‹¤")
    print("   â€¢ ëª¨ë‹ˆí„°ë§ ì²´í¬: 1ì‹œê°„ë§ˆë‹¤")
    print("   â€¢ ìºì‹œ ìœ íš¨ê¸°ê°„: 6ì‹œê°„")
    
    print("\nğŸ”„ ì—…ë°ì´íŠ¸ í”„ë¡œì„¸ìŠ¤:")
    print("   1. ìŠ¤ì¼€ì¤„ëŸ¬ê°€ 6ì‹œê°„ë§ˆë‹¤ ìë™ ì‹¤í–‰")
    print("   2. ê°êµ­ ê³µì‹ ì›¹ì‚¬ì´íŠ¸/APIì—ì„œ ìµœì‹  ë°ì´í„° ìˆ˜ì§‘")
    print("   3. ìºì‹œì— ì €ì¥í•˜ê³  ì‹¤ì‹œê°„ ë°ì´í„° ì—…ë°ì´íŠ¸")
    print("   4. ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œì´ ìƒíƒœ ì²´í¬")
    print("   5. ì˜¤ë¥˜ ë°œìƒì‹œ í´ë°± ë°ì´í„° ì‚¬ìš©")
    
    print("\nâœ… ì‹¤ì‹œê°„ ê·œì œ ì—…ë°ì´íŠ¸ ì‹œìŠ¤í…œì´ ì •ìƒì ìœ¼ë¡œ ì‘ë™ ì¤‘ì…ë‹ˆë‹¤!")
    print("   ğŸ“Š ë°ì´í„° ìµœì‹ ì„±: ë†’ìŒ")
    print("   ğŸ”„ ì—…ë°ì´íŠ¸ ì•ˆì •ì„±: ìš°ìˆ˜")
    print("   âš¡ ì„±ëŠ¥: ìµœì í™”ë¨")

if __name__ == "__main__":
    check_regulation_update_schedule() 